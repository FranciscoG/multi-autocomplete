function MultiComplete(t){"use strict";if(!(this instanceof MultiComplete))return new MultiComplete(t);if(this.input=t.input,this.$input=$(t.input),!t.input||!this.$input.length)return void this.warn("input not set or doesn't exist");if(this.output=t.output,this.$output=$(t.output),!t.output||!this.$output.length)return void this.warn("preview container not set or doesn't exist");if(!t.datasets)return void this.warn("datasets missing");this.datasets=t.datasets;var e="";for(var i in this.datasets)e+=i;this.markers=new RegExp("["+e+"]","i"),this.outputDom=t.outputDom||"li",this.keycodes={up:38,down:40,left:37,right:39,enter:13,esc:27,tab:9,shift:16,del:8},this.info={},$("body").on("keyup",t.input,this.onKeyUp.bind(this))}MultiComplete.prototype={warn:function(t){console&&console.warn&&console.warn("mutli-autocomplete:",t)},goForward:function(t,e){for(var i=strLen=t.length,n=e;n<strLen;n++)if(" "===t[n]){i=n;break}return i},goBackward:function(t,e){for(var i=0,n=e-1;n>=0;n--)if(" "===t[n]){i=n+1;break}return i},onKeyUp:function(t){var e=this.$input.val();if(e){var i,n,s=this.$input.get(0).selectionStart,o=e[s-1];n=" "===e[s]?s:this.goForward(e,s),i=" "===o?s:this.goBackward(e,s);var r=e.substring(i,n);this.info={start:i,end:n,fullStr:r,filterStr:r.substr(1),val:e};var a=r.charAt(0);return void(this.markers.test(a)?(this.info.activeMarker=a,this.beginFiltering(a,r.substr(1)),this.bindPreview(t.keyCode)):this.clearPreview())}e&&this.info.activeMarker||this.clearPreview()},clearPreview:function(){document.querySelector(this.output).innerHTML=""},beginFiltering:function(t,e){if(this.datasets[t]){var i=this.datasets[t],n=i.filter(function(t,i,n){return t.indexOf(e)>=0});this.addToPreview(n)}},addToPreview:function(t){var e=document.querySelector(this.output);this.clearPreview();var i=this.outputDom,n=document.createDocumentFragment();t.forEach(function(t,e){var s=document.createElement(i);s.textContent=t,0===e&&s.classList.add("active"),n.appendChild(s)}),e.appendChild(n)},bindPreview:function(t){var e,i=this.$output.find(".active");t===this.keycodes.up?(i.removeClass("active"),e=i.index()-1):t===this.keycodes.down&&(i.removeClass("active"),e=i.index()+1);var n=this.$output.children().length-1;0>e?e=n:e>=n&&(e=0),console.log(e),this.$output.children().eq(e).addClass("active")},replaceInPlace:function(t){var e=this.info.val,i=e.slice(0,this.startPosition)+t+e.slice(this.lastCursorPos,e.length-1);console.log(i)}},"object"==typeof exports&&(module.exports=MultiComplete);